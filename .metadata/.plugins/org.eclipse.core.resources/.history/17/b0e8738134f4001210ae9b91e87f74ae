/*
 * pz.cpp
 *
 *  Created on: 2013/07/24
 *      Author: yumikoy
//
//void printl(int l[4]){
//	for(int i = 0; i < 4; i++){
//		printf("%d", l[i]);
//	}
//	printf("\n");
//}
//
//void print12(int l[4], int fromto[2]){
//	for(int i = 0; i<12; i++){
//		swap(l, fromto);
//		printl(l);
//	}
//}
//
//int factorial(int n){
//	int result = 1;
//	for(int i = 1; i <= n; i++){
//		result *= i;
//	}
//	return result;
//}
//
//int main(){
////	int fromto12[2] = {1,2};
////	int fromto13[2] = {1,3};
////	int fromto24[2] = {2,4};
////	int fromto34[2] = {3,4};
//
////	int fromtos[4][2] = {{1,2}, {3,1}, {2,4}, {4,3}};
//////	printl(l);
////	for(int i = 0; i < 4; i++){
////		int l[4] = {1,2,3,4};
////		print12(l, fromtos[i]);
////	}
//
//	printf("%d\n", factorial(6));
//
//	printf("end");
//}
 */


#include <set>
#include <stdio.h>
#include <math.h>
#include <iostream>
using namespace std;

set<int> nums;  // ‹ó‚Ìset

int nonp(int l, int p){
	return fmod(l / pow(10, 9-p) , 10);
}

int swap(int l, int from, int to) {
//	int swap(int l, int fromto[2]) {
//	int from = fromto[0],to = fromto[1];
	int f = fmod(l / pow(10, 9-from) , 10);
	int t = fmod(l / pow(10, 9-to), 10);
//	printf("%d, %d\n", f, t);
	int hd,ld,hn,ln;
	if(from < to){
		hd = from; ld = to; hn = f; ln = t;
	} else {
		hd = to; ld = from; hn = t; ln = f;
	}
//	printf("%d,%d,%d,%d\n", hd, ld, hn, ln);
//	printf("%f\n", pow(10,9-hd)-pow(10,9-ld));
	return l + (pow(10,9-hd)-pow(10,9-ld))*(ln-hn);
}

int con[][4] = {{2,4,-1,-1},{1,3,5,-1},{2,6,-1,-1},
		{1,5,7,-1},{2,4,6,8},{3,5,9,-1},
		{4,8,-1,-1},{5,7,9,-1},{6,8,-1,-1}};

void enumer(int l, int have, int p){
	int* nextps = con[p-1];
	for(int i=0; i<4; i++){
		int nextp = nextps[i];
		if(nextp==-1)
			break;
		int swapped = swap(l, p, nextp);
		printf("%d->%d  %d\n", p, nextp, swapped);
		pair<set<int>::iterator, bool> result = nums.insert(swapped);
		if(!result.second){
			printf("!\n");
			return;
		}
//		enumer(swapped, have, nextp);
	}

}
void enumerStart(int l, int start){

	int* cons = con[start-1];
	int have = nonp(l, start);
	for(int i=0; i<4; i++){
		if(cons[i]==-1)
			break;
		printf("s%d->%d ", start, cons[i]);
		int swapped = swap(l, start, cons[i]);
		printf("%d\n", swapped);
		pair<set<int>::iterator, bool> result = nums.insert(swapped);
//		printf("%d", result.second);
		if(!result.second){
			printf("!\n");
			return;
		}
		enumer(swapped, have, cons[i]);
	}
}

int main() {


	int l = 123456789;
	// —v‘f‚ğ’Ç‰Á‚·‚é
	nums.insert(l);
	nums.insert(l);
	printf(nums.find(987654321) == nums.end() ? "nai" : "aru");
	printf(nums.find(123456789) == nums.end() ? "nai" : "aru");
	printf("\n");

	enumerStart(l,1);
//	int fromto[2];
//	int fromto[] = { 1, 3 };

//	printf("%d\n", swap(l, fromto));
//	nums.insert(swap(l,fromto));
//	enumer(l,1);

	// —v‘f‚ğo—Í‚·‚é
//	set<int>::iterator it = nums.begin();
//	while (it != nums.end()) {
//		cout << *it << endl;
//		++it;
//	}

	cout << "—v‘f”F" << (unsigned int) nums.size() << endl;
//	nums.clear();

	return 0;
}
